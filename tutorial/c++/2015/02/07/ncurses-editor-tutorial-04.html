<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="/css/main.css">

<!-- Custom stylesheets -->


    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>NCURSES Terminal Text Editor Tutorial Part 4 | Cheuk’s Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="NCURSES Terminal Text Editor Tutorial Part 4" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Salutations!" />
<meta property="og:description" content="Salutations!" />
<meta property="og:site_name" content="Cheuk’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-02-07T15:50:00-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NCURSES Terminal Text Editor Tutorial Part 4" />
<script type="application/ld+json">
{"headline":"NCURSES Terminal Text Editor Tutorial Part 4","dateModified":"2015-02-07T15:50:00-08:00","datePublished":"2015-02-07T15:50:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/tutorial/c++/2015/02/07/ncurses-editor-tutorial-04.html"},"description":"Salutations!","@type":"BlogPosting","url":"/tutorial/c++/2015/02/07/ncurses-editor-tutorial-04.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    
  <head>

  <body>
    <div class="wrapper">
      <nav>
  <a href="/" class="nav-title">
    Cheuk's Blog
  </a>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <a class="nav-links" href="/resources/">Resources</a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  <a class="nav-links" href="/about/">About</a>
  
  
</nav>

      
      <article class="post">
  <h1 class="title">NCURSES Terminal Text Editor Tutorial Part 4</h1>
  <span>
    <span>
    Tags:
    
    <a href="/tag/tutorial">
      tutorial
    </a>
    
    <a href="/tag/c++">
      c++
    </a>
    
    <a href="/tag/ncurses">
      ncurses
    </a>
    
    <a href="/tag/editor">
      editor
    </a>
    
    </span>
    <span class="meta">07 Feb 2015</span>
  </span>

  

<ul class="nav nav-pills">
  
  

  

  

  
      <li><a href="/tutorial/c++/2015/02/01/ncurses-editor-tutorial-01.html">NCURSES Terminal Text Editor Tutorial Part 1</a></li>
  

  
      <li><a href="/tutorial/c++/2015/02/01/ncurses-editor-tutorial-02.html">NCURSES Terminal Text Editor Tutorial Part 2</a></li>
  

  
      <li><a href="/tutorial/c++/2015/02/04/ncurses-editor-tutorial-03.html">NCURSES Terminal Text Editor Tutorial Part 3</a></li>
  

  
      <li><a href="/tutorial/c++/2015/02/07/ncurses-editor-tutorial-04.html">NCURSES Terminal Text Editor Tutorial Part 4</a></li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  


</ul>

<h2 id="salutations">Salutations!</h2>

<p>Just gonna apologize for the weird intros - I’m starting to run out of phrases
to start the intro. Last time we left off, we finished a bunch of
implementations such as the input handler, moving directions, etc. Now, we are
going to finish up everything!</p>

<h2 id="printing-the-buffer">Printing the Buffer</h2>

<p>Printing the buffer is a somewhat easy task <strong>if you don’t what a scrolling
feature</strong>. I know how to do it but I can’t implement it without it going wrong
with a ton of bugs. This one here will just be a simple for-loop with no
scrolling feature.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="n">Editor</span><span class="o">::</span><span class="n">printBuff</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">LINES</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">buff</span><span class="o">-&gt;</span><span class="n">lines</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="n">move</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
            <span class="n">clrtoeol</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">mvprintw</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">buff</span><span class="o">-&gt;</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c_str</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="n">clrtoeol</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">move</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Note that this will only be good with files that have lines less than the number
of lines your terminal could display on your screen.</p>

<h2 id="printing-the-status-line">Printing the Status Line</h2>

<p>I like my status line on the last line of the terminal (<strong><em>just like … oh
whatever, you get the drift</em></strong>). You could put it somewhere else, if you like.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="n">Editor</span><span class="o">::</span><span class="n">printStatusLine</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">attron</span><span class="p">(</span><span class="n">A_REVERSE</span><span class="p">);</span>
    <span class="n">mvprintw</span><span class="p">(</span><span class="n">LINES</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">status</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
    <span class="n">clrtoeol</span><span class="p">();</span>
    <span class="n">attroff</span><span class="p">(</span><span class="n">A_REVERSE</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="finishing-up">Finishing up</h2>

<p>Okay! We are almost done! Three simple functions stand in our way: the 2
variations of the <code class="language-plaintext highlighter-rouge">Editor::deleteLine</code> function, and the most important
<code class="language-plaintext highlighter-rouge">Editor::saveFile()</code> function!</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="n">Editor</span><span class="o">::</span><span class="n">deleteLine</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">buff</span><span class="o">-&gt;</span><span class="n">removeLine</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">Editor</span><span class="o">::</span><span class="n">deleteLine</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">buff</span><span class="o">-&gt;</span><span class="n">removeLine</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Editor::saveFile()</code> function:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="n">Editor</span><span class="o">::</span><span class="n">saveFile</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">filename</span> <span class="o">==</span> <span class="s">""</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Set filename to untitled</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s">"untitled"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">ofstream</span> <span class="n">f</span><span class="p">(</span><span class="n">filename</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
    <span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">buff</span><span class="o">-&gt;</span><span class="n">lines</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">buff</span><span class="o">-&gt;</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s">"Saved to file!"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s">"Error: Cannot open file for writing!"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="afterthoughts">Afterthoughts</h2>

<p>That was fun, wasn’t it? Some ideas for other features to add to this editor:</p>

<ul>
  <li><strong><em>Scrolling</em></strong></li>
  <li>Syntax highlighting for some language</li>
  <li>Deleting line(s) and other features that were included in vim</li>
</ul>

<h2 id="source-code">Source Code</h2>

<p>The sources to this <strong>EXACT TUTORIAL</strong> (as well as the Makefile) may be found in
this tar file <a href="/res/tutorials/ncurses-ced-tut.tar.gz">here</a>.</p>



<ul class="nav nav-pills">
  
  

  

  

  
      <li><a href="/tutorial/c++/2015/02/01/ncurses-editor-tutorial-01.html">NCURSES Terminal Text Editor Tutorial Part 1</a></li>
  

  
      <li><a href="/tutorial/c++/2015/02/01/ncurses-editor-tutorial-02.html">NCURSES Terminal Text Editor Tutorial Part 2</a></li>
  

  
      <li><a href="/tutorial/c++/2015/02/04/ncurses-editor-tutorial-03.html">NCURSES Terminal Text Editor Tutorial Part 3</a></li>
  

  
      <li><a href="/tutorial/c++/2015/02/07/ncurses-editor-tutorial-04.html">NCURSES Terminal Text Editor Tutorial Part 4</a></li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  


</ul>

</article>

<footer class="post-foot">
  <span class="prev">
  
    <span>Prev</span>
    <a href="/tutorial/c++/2015/02/04/ncurses-editor-tutorial-03.html">NCURSES Terminal Text Editor Tutorial Part 3</a>
  
  </span>
  <span class="next">
  
    <span>Next</span>
    <a href="/qbasic/2015/02/23/fun-with-qbasic.html">Fun with QBasic</a>
  
  </span>
</footer>

    </div>
  </body>

</html>
